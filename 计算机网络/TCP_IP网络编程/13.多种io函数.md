# 知识点
Linux 中的send & recv
```cpp
#include <sys/socket.h>

ssize_t send(int sockfd, const void* buf, size_t nbytes, int flags);
ssize_t recv(int sockfd, void*buf, size_t nbytes, int flags);
```
flags: 是收发数据是的可选项
  MSG_OOB
  MSG_PEEK
  MSG_DONTROUTE
  MSG_DONTWAIT
  MSG_WAITALL


# 习题
## 1. 下列关于MSG_OOB可选项的说法错误的是？
1. MSG_OOB指传输Out-of-band数据，是通过其他路径高速传输数据

不准确，TCP的带外数据并非通过其他路径传输，所有数据都通过同一TCP连接，但带外数据有特殊的处理机制

2. MSG_OOB指通过其他路径高速传输数据，因此，TCP中设置该选项的数据先到对方主机

错误的，因为MSG_OOB数据并不通过其他路径，也不会比普通数据先到达。

3. 设置MSG_OOB使数据先到达对方主机后，以普通数据的形式和顺序读取。也就是说，只是提高了传输速度，接收方无法识别这一点

错误，使用MSG_OOB发送的带外数据并不会加快数据传输速度，也不会使得数据以普通数据的形式读取。实际上，MSG_OOB是TCP中的一种紧急标志，用于标记紧急数据。当接收方接收到带有MSG_OOB的数据时，会通过特定的方法（如recv函数中指定MSG_OOB选项）来读取这些紧急数据。

4. MSG_OOB无法脱离TCP的默认数据传输方式。即使设置了MSG_OOB，也会保持原有数据顺序。该选项只用于要求接收方紧急处理

正确的说法，带外数据是紧急标志，不破坏数据顺序。

## 2. 利用readv&writev函数收发数据有何优点？分别从函数调用次数和IO缓冲的角度给出说明

减少函数调用次数
优点:
  readv 和 writev 函数允许一次调用读取或写入多个非连续的内存缓冲区，而无需多次调用 read 或 write 函数。
  通过减少系统调用的次数，可以降低系统调用的开销，提升程序的执行效率。
说明:
  如果不使用 readv 或 writev，你可能需要多次调用 read 或 write 函数分别读取或写入每个缓冲区的数据。而每次系统调用都需要用户态和内核态之间的上下文切换，这会增加性能开销。

优化IO缓冲管理
优点:
  readv 和 writev 函数支持“散布/聚集”IO操作，即可以将多个缓冲区的数据一次性读入（或写出）到一个文件描述符。
  这种方式避免了将多个小的缓冲区合并为一个大缓冲区的额外拷贝操作，从而优化了内存使用和IO操作的效率。
说明:
  在没有 readv 和 writev 的情况下，如果你需要将多个数据块写入一个文件描述符，通常会先将这些数据块复制到一个连续的大缓冲区，然后调用 write 函数写入。这不仅增加了内存占用，也引入了额外的拷贝操作。
  使用 writev 可以直接将多个分散的缓冲区数据写入文件描述符，避免了合并操作。类似地，readv 可以将从文件描述符中读取的数据分散到多个缓冲区中。
## 3. 通过recv函数验证输入缓冲是否存在数据时（确认后立即返回时），如何设置recv函数最后一个参数中的可选项？分别书名各可选项的含义

MSG_PEEK
  含义: 这个选项用于“窥视”缓冲区中的数据，而不会从缓冲区中实际移除数据。也就是说，使用 MSG_PEEK 选项调用 recv 函数时，即使数据被读取了，它仍然会保留在缓冲区中，后续的 recv 调用可以再次读取到相同的数据。
  用途: 当你想检查缓冲区中是否有数据而不影响数据状态时使用 MSG_PEEK。

MSG_DONTWAIT
  含义: 这个选项使得 recv 函数以非阻塞方式工作。如果输入缓冲区中没有数据，recv 函数会立即返回，而不会阻塞等待数据的到来。通常会返回 -1，并且设置 errno 为 EAGAIN 或 EWOULDBLOCK。
  用途: 当你希望程序非阻塞地检查是否有数据可读时使用 MSG_DONTWAIT。

MSG_WAITALL
  含义: 这个选项使得 recv 函数等待接收完整的请求字节数才返回，除非遇到错误或者连接关闭。如果请求的字节数比缓冲区中的数据多，函数会阻塞，直到接收到足够的数据。
  用途: 当你需要确保接收到指定长度的数据时使用 MSG_WAITALL。

MSG_OOB
  含义: 这个选项用于读取带外数据（Out-of-band data），即紧急数据。带外数据是通过 MSG_OOB 标记的，通常由发送方标记为紧急处理。
  用途: 当你需要读取发送方发送的带外数据时使用 MSG_OOB。

MSG_TRUNC
  含义: 这个选项与 recvfrom 函数一起使用时，在数据包被截断时返回数据包的完整大小，而不仅仅是接收到的部分。用于数据报套接字。
  用途: 在对数据报进行操作时使用 MSG_TRUNC 以获取完整的数据包大小。
